"""
시각적 요소와 포맷팅 활용법 실습 모듈

Part 7 - 섹션 7.3.2 실습 코드: 정보의 가독성과 명확성을 높이는 다양한 시각적 요소와 포맷팅 기법을 학습합니다.
"""

import os
import sys
from typing import Dict, List, Any, Optional

# 상위 디렉토리를 경로에 추가하여 utils 모듈을 import할 수 있게 설정
current_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.dirname(os.path.dirname(os.path.dirname(current_dir)))
sys.path.append(project_root)

from utils.prompt_builder import PromptBuilder
from utils.exercise_template import run_exercise

# 주제 옵션 정의
VISUAL_FORMATTING_TOPICS = {
    "1": {"name": "텍스트 다이어그램", "topic": "텍스트만으로 효과적인 다이어그램과 시각적 구조 표현하기", "output_format": "다이어그램 가이드"},
    "2": {"name": "마크다운 포맷팅", "topic": "마크다운 형식을 활용한 정보의 시각적 계층화 및 강조", "output_format": "포맷팅 가이드"},
    "3": {"name": "데이터 시각화", "topic": "텍스트 기반 데이터 표현 및 패턴 강조 기법", "output_format": "데이터 시각화 가이드"},
    "4": {"name": "문서 레이아웃", "topic": "효과적인 정보 전달을 위한 문서 구조 및 공간 활용법", "output_format": "레이아웃 가이드"},
    "5": {"name": "시각적 계층구조", "topic": "정보의 중요도와 관계를 명확히 전달하는 시각적 계층화 방법", "output_format": "계층화 가이드"}
}

# 프롬프트 요약 정보
PROMPT_SUMMARY = {
    "basic": ["주제에 대한 일반적인 정보 요청"],
    "enhanced": [
        "시각적 구조: 다양한 다이어그램과 레이아웃 활용",
        "텍스트 포맷팅: 강조, 구분, 계층화 기법 적용",
        "공간 활용: 효과적인 여백과 배치 전략 활용",
        "시각적 리듬: 일관된 패턴과 구조적 흐름 적용"
    ]
}

# 학습 포인트
LEARNING_POINTS = [
    "시각적 요소는 단순한 장식이 아닌 정보 전달의 핵심 구성 요소입니다",
    "텍스트만으로도 다양한 다이어그램과 구조적 표현이 가능합니다",
    "효과적인 포맷팅은 정보의 계층과 중요도를 직관적으로 전달합니다",
    "시각적 일관성과 패턴은 정보 처리와 기억을 용이하게 합니다"
]

def get_basic_prompt(topic: str) -> str:
    """기본 프롬프트 생성"""
    return f"{topic}에 대해 설명해주세요."

def get_enhanced_prompt(topic: str, purpose: str, output_format: str) -> str:
    """향상된 프롬프트 생성"""
    builder = PromptBuilder()
    
    # 주제별 맞춤 역할 및 맥락 설정
    if "텍스트 다이어그램" in topic:
        builder.add_role(
            "텍스트 시각화 전문가", 
            "일반 텍스트만으로 복잡한 구조, 관계, 프로세스를 시각적으로 표현하는 다이어그램 설계 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"마크다운 환경에서 특수 문자와 텍스트만으로 효과적인 다이어그램과 시각적 구조를 표현하는 방법을 배우고 싶습니다. "
            f"순서도, 관계도, 트리 구조, 프로세스 흐름 등을 텍스트만으로 어떻게 명확하게 표현할 수 있는지 알고 싶습니다."
        )
        
        builder.add_instructions([
            "텍스트 기반 다이어그램의 다양한 유형(순서도, 트리 구조, 관계도 등)과 각각의 적합한 사용 상황을 설명해주세요",
            "ASCII/유니코드 문자를 활용한 다이어그램 요소(상자, 선, 화살표, 연결점 등) 생성 방법을 제시해주세요",
            "복잡한 관계와 흐름을 명확하게 표현하기 위한 텍스트 다이어그램 설계 원칙을 설명해주세요",
            "실용적인 다이어그램 템플릿(순서도, 의사결정 트리, 조직도, 프로세스 흐름도 등)을 제공해주세요",
            "텍스트 다이어그램의 가독성과 명확성을 높이는 팁과 테크닉을 공유해주세요"
        ])
        
    elif "마크다운 포맷팅" in topic:
        builder.add_role(
            "마크다운 포맷팅 전문가", 
            "마크다운 문법을 활용하여 정보를 시각적으로 구조화하고 강조하는 문서 설계 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"마크다운의 다양한 포맷팅 요소를 활용하여 정보의 계층, 중요도, 관계를 시각적으로 명확하게 전달하는 방법을 배우고 싶습니다. "
            f"특히 기본 마크다운 문법 내에서 창의적인 포맷팅 기법과 시각적 패턴을 활용하는 방법에 대한 지침이 필요합니다."
        )
        
        builder.add_instructions([
            "마크다운 포맷팅의 기본 요소(제목, 강조, 목록, 인용, 코드 블록 등)와 각각의 시각적 효과를 설명해주세요",
            "정보의 계층과 구조를 명확하게 표현하기 위한 마크다운 포맷팅 전략을 제시해주세요",
            "텍스트의 시각적 리듬과 패턴을 생성하는 포맷팅 기법을 설명해주세요",
            "다양한 문서 유형(학술 문서, 기술 문서, 프로젝트 문서 등)에 최적화된 마크다운 포맷팅 템플릿을 제공해주세요",
            "마크다운 포맷팅의 일관성과 가독성을 높이는 모범 사례와 팁을 공유해주세요"
        ])
        
    elif "데이터 시각화" in topic:
        builder.add_role(
            "텍스트 기반 데이터 시각화 전문가", 
            "ASCII/유니코드 문자와 마크다운 포맷팅만으로 데이터 패턴과 트렌드를 시각적으로 표현하는 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"그래픽 도구 없이 텍스트만으로 데이터를 시각적으로 표현하고 패턴을 강조하는 방법을 배우고 싶습니다. "
            f"특히 마크다운 환경에서 수치 데이터, 비교, 트렌드 등을 효과적으로 시각화하는 기법에 대한 지침이 필요합니다."
        )
        
        builder.add_instructions([
            "텍스트 기반 데이터 시각화의 다양한 유형(차트, 그래프, 스파크라인 등)과 각각의 적합한 사용 상황을 설명해주세요",
            "ASCII/유니코드 문자를 활용한 데이터 표현 방법(막대 그래프, 선 그래프, 히스토그램 등)을 제시해주세요",
            "데이터 패턴과 트렌드를 강조하기 위한 시각적 테크닉(명암, 기호, 정렬 등)을 설명해주세요",
            "다양한 데이터 유형(시계열, 비교, 분포, 관계 등)에 최적화된 텍스트 기반 시각화 템플릿을 제공해주세요",
            "텍스트 기반 데이터 시각화의 명확성과 해석 용이성을 높이는 팁과 가이드라인을 공유해주세요"
        ])
        
    elif "문서 레이아웃" in topic:
        builder.add_role(
            "문서 디자인 전문가", 
            "텍스트 기반 환경에서도 효과적인 정보 전달을 위한 레이아웃과 공간 활용 전략을 설계하는 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"마크다운과 같은 텍스트 기반 환경에서 문서의 구조, 흐름, 가독성을 높이기 위한 레이아웃 전략을 배우고 싶습니다. "
            f"특히 제한된 포맷팅 옵션 내에서도 시각적으로 매력적이고 효과적인 문서 디자인을 구현하는 방법에 대한 지침이 필요합니다."
        )
        
        builder.add_instructions([
            "텍스트 기반 문서의 효과적인 레이아웃 원칙과 전략을 설명해주세요",
            "섹션 구분, 여백, 정렬 등을 활용한 문서 구조화 방법을 제시해주세요",
            "텍스트 밀도, 분량, 배치를 최적화하여 가독성을 높이는 기법을 설명해주세요",
            "다양한 문서 유형(보고서, 가이드, 프레젠테이션 등)에 최적화된 레이아웃 템플릿을 제공해주세요",
            "제한된 포맷팅 환경에서도 시각적 매력과 전문성을 높이는 디자인 팁을 공유해주세요"
        ])
        
    elif "시각적 계층구조" in topic:
        builder.add_role(
            "정보 계층화 전문가", 
            "텍스트 기반 환경에서 정보의 중요도, 관계, 계층을 시각적으로 명확하게 표현하는 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"복잡한 정보 구조에서 주요 포인트, 하위 항목, 관련성 등을 시각적으로 명확하게 표현하는 방법을 배우고 싶습니다. "
            f"특히 마크다운 환경에서 정보의 계층적 관계를 직관적으로 전달하는 시각적 전략에 대한 지침이 필요합니다."
        )
        
        builder.add_instructions([
            "정보의 시각적 계층화를 위한 핵심 원칙과 패턴을 설명해주세요",
            "제목, 들여쓰기, 기호, 강조 등을 활용한 계층 표현 방법을 제시해주세요",
            "복잡한 정보 구조(트리, 네트워크, 매트릭스 등)를 텍스트로 효과적으로 표현하는 기법을 설명해주세요",
            "다양한 정보 유형(개념 맵, 지식 체계, 조직 구조 등)에 최적화된 계층화 템플릿을 제공해주세요",
            "시각적 계층 구조의 명확성과 직관성을 높이는 모범 사례와 팁을 공유해주세요"
        ])
        
    else:
        builder.add_role(
            "시각적 커뮤니케이션 전문가", 
            "텍스트 기반 환경에서도 정보를 시각적으로 효과적으로 전달하는 기법과 전략을 개발하는 전문가입니다."
        )
        
        builder.add_context(
            f"저는 {topic}에 관심이 있습니다. "
            f"제한된 포맷팅 옵션 내에서도 정보를 시각적으로 매력적이고 명확하게 전달하는 방법을 배우고 싶습니다. "
            f"특히 텍스트와 기본 마크다운 요소만으로 시각적 계층, 강조, 관계를 표현하는 창의적인 방법에 대한 지침이 필요합니다."
        )
        
        builder.add_instructions([
            "텍스트 기반 시각적 커뮤니케이션의 핵심 원칙과 전략을 설명해주세요",
            "마크다운 포맷팅 요소를 창의적으로 활용한 시각화 방법을 제시해주세요",
            "정보의 구조, 흐름, 관계를 텍스트로 효과적으로 표현하는 기법을 설명해주세요",
            "다양한 커뮤니케이션 목적(교육, 설득, 정보 제공 등)에 최적화된 시각적 템플릿을 제공해주세요",
            "텍스트 기반 시각적 커뮤니케이션의 효과를 높이는 모범 사례와 팁을 공유해주세요"
        ])
    
    # 출력 형식 지정
    builder.add_format_instructions(
        f"응답은 {output_format} 형식으로 구성해주세요. "
        f"마크다운 형식을 사용하여 다음 요소를 효과적으로 활용해주세요:\n\n"
        f"1. 명확한 제목 계층 구조 (##, ###, ####)\n"
        f"2. 글머리 기호와 번호 매기기를 적절히 활용한 목록\n"
        f"3. 표를 사용한 정보 비교 및 구조화\n"
        f"4. 인용문(>)을 활용한 중요 포인트 강조\n"
        f"5. 코드 블록을 활용한 예시 및 템플릿 표현\n"
        f"6. 굵은 글씨와 기울임체를 활용한 강조\n"
        f"7. 텍스트 다이어그램과 시각적 구조 요소\n\n"
        f"다음 섹션을 포함해주세요:\n"
        f"1. 개요: 해당 시각적 요소/포맷팅 기법의 목적과 적합한 상황\n"
        f"2. 핵심 원칙: 효과적인 시각적 표현을 위한 기본 원칙\n"
        f"3. 시각화 방법: 구체적인 기법과 구현 방법\n"
        f"4. 실용적 예시: 다양한 상황에 적용된 구체적 예시\n"
        f"5. 템플릿: 재사용 가능한 시각적 템플릿\n"
        f"6. 활용 팁: 효과적인 사용을 위한 실용적 조언\n\n"
        f"각 섹션은 설명과 함께 실제 시각적 예시를 포함하여 이론과 실습을 모두 제공해주세요. "
        f"설명하는 시각적 요소를 실제로 응답 내에 구현하여 시연해주세요."
    )
    
    return builder.build()

def main():
    """메인 함수"""
    # 실행 결과를 저장할 때 챕터별 폴더 구조를 사용
    run_exercise(
        title="시각적 요소와 포맷팅 활용법",
        topic_options=VISUAL_FORMATTING_TOPICS,
        get_basic_prompt=get_basic_prompt,
        get_enhanced_prompt=get_enhanced_prompt,
        prompt_summary=PROMPT_SUMMARY,
        learning_points=LEARNING_POINTS
    )

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\n프로그램이 사용자에 의해 중단되었습니다.")
    except Exception as err:
        print(f"\n오류 발생: {err}")
        print("API 키나 네트워크 연결을 확인하세요.")