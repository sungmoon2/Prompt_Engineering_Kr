"""
인문/사회과학 논증 및 분석 방법 실습 모듈

Part 6 - 섹션 6.2.3 실습 코드: 인문학과 사회과학 분야의 논증 및 분석 방법에 최적화된
프롬프트 작성법을 학습합니다.
"""

import os
import sys
from typing import Dict, List, Any, Optional

# 상위 디렉토리를 경로에 추가하여 utils 모듈을 import할 수 있게 설정
current_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.dirname(os.path.dirname(os.path.dirname(current_dir)))
sys.path.append(project_root)

from utils.prompt_builder import PromptBuilder
from utils.exercise_template import run_exercise

# 주제 옵션 정의
HUMANITIES_PROMPTS_TOPICS = {
    "1": {"name": "문학/철학", "topic": "문학 작품/철학적 개념의 비평적 분석", "output_format": "해석적 에세이"},
    "2": {"name": "사회학/인류학", "topic": "사회 현상의 사회문화적 분석", "output_format": "이론적 분석"},
    "3": {"name": "역사/문화 연구", "topic": "역사적 사건/문화 현상의 맥락적 해석", "output_format": "역사적 분석"},
    "4": {"name": "심리학/교육학", "topic": "인간 행동/학습 과정의 이론적 이해", "output_format": "개념 분석"},
    "5": {"name": "정치학/경제학", "topic": "정치경제적 이슈의 다차원적 분석", "output_format": "정책 분석"}
}

# 프롬프트 요약 정보
PROMPT_SUMMARY = {
    "basic": ["주제에 대한 일반적인 설명 요청"],
    "enhanced": [
        "다양한 관점 요청: 여러 이론적 렌즈/접근법 통합",
        "맥락적 분석: 역사적/사회문화적 맥락 고려 요청",
        "비판적 성찰: 전제와 한계에 대한 검토 강조",
        "해석적 깊이: 표면적 설명 너머 의미와 함의 탐색"
    ]
}

# 학습 포인트
LEARNING_POINTS = [
    "인문/사회과학은 해석적 접근, 다양한 관점, 맥락적 이해, 비판적 성찰을 중시하므로 이를 프롬프트에 반영해야 합니다",
    "문학, 철학, 역사, 사회학 등 다양한 인문/사회과학 분야에 맞춘 특화된 프롬프트 패턴을 활용하면 더 풍부한 분석을 얻을 수 있습니다",
    "텍스트 분석, 담론 분석, 비교 분석 등 다양한 인문/사회과학 연구 방법론을 프롬프트에 통합하면 체계적인 분석이 가능합니다",
    "다양한 관점과 비판적 성찰을 촉진하는 프롬프트는 복잡한 인문/사회과학적 주제에 대한 균형 잡힌 이해를 가능하게 합니다",
    "인문/사회과학적 탐구를 위한 체계적인 질문 전략을 개발하면 표면적 설명 너머 깊은 통찰을 얻을 수 있습니다"
]

def get_basic_prompt(topic: str) -> str:
    """기본 프롬프트 생성"""
    return f"{topic}에 대해 분석해주세요."

def get_enhanced_prompt(topic: str, purpose: str, output_format: str) -> str:
    """향상된 프롬프트 생성"""
    builder = PromptBuilder()
    
    # 분야별 역할 및 맥락 설정
    if "문학" in purpose or "철학" in purpose:
        builder.add_role(
            "문학/철학 비평가",
            "대학에서 비교문학과 철학을 가르치는 교수로, 다양한 이론적 렌즈를 통해 텍스트와 개념을 해석하고 비판적으로 분석하는 전문가"
        )
        
        builder.add_context(
            f"저는 인문학을 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"알베르 카뮈의 소설 '이방인'을 실존주의 철학의 관점에서 분석하고자 합니다. "
            f"특히 소설에 나타난 부조리, 소외, 자유, 책임과 같은 실존주의적 주제와 "
            f"카뮈의 철학적 사상이 어떻게 문학적으로 표현되는지 깊이 있게 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            "'이방인'의 서사 구조, 문체, 인물 특성 등 문학적 요소를 실존주의적 주제와 연결하여 분석해주세요",
            "카뮈의 부조리 철학이 소설에서 어떻게 구체화되는지 주요 장면과 상징을 통해 설명해주세요",
            "니체, 사르트르, 키르케고르 등 다른 실존주의 사상가들의 개념과 비교하여 카뮈의 독특한 관점을 조명해주세요",
            "역사적, 문화적 맥락(2차 세계대전, 알제리 식민지 등)이 작품의 철학적 메시지에 미치는 영향을 고려해주세요",
            "다양한 비평적 관점(실존주의적, 구조주의적, 포스트콜로니얼 등)에서 작품을 해석하고 그 차이점을 비교해주세요",
            "작품의 현대적 관련성과 철학적 함의에 대한 비판적 성찰도 포함해주세요"
        ])
        
    elif "사회학" in purpose or "인류학" in purpose:
        builder.add_role(
            "사회문화 분석가",
            "사회학과 문화인류학의 이론적 틀을 통합적으로 활용하여 복잡한 사회 현상을 분석하고 해석하는 학자로, 구조와 행위자성, 거시와 미시적 차원을 연결하는 전문가"
        )
        
        builder.add_context(
            f"저는 사회과학을 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"소셜 미디어가 현대 사회의 정체성 형성과 공동체 의식에 미치는 영향을 분석하려고 합니다. "
            f"특히 디지털 공간에서의 자아 표현, 사회적 관계 형성, 집단 소속감의 변화를 "
            f"다양한 사회학적, 인류학적 이론 틀을 통해 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            "소셜 미디어와 정체성 형성의 관계를 분석하는 다양한 이론적 관점(상징적 상호작용론, 구조주의, 실천이론 등)을 비교 설명해주세요",
            "온라인 공간에서의 자아 표현과 퍼포먼스가 어떻게 정체성 구성에 기여하는지 고프만의 인상 관리 이론 등을 활용하여 분석해주세요",
            "디지털 공동체와 전통적 공동체의 차이점과 유사점을 사회적 자본, 유대감, 소속감의 관점에서 고찰해주세요",
            "소셜 미디어가 만드는 새로운 권력 구조와 불평등(디지털 격차, 알고리즘적 배제 등)을 비판적으로 분석해주세요",
            "연령, 성별, 계층, 문화적 배경에 따른 소셜 미디어 사용과 경험의 차이를 교차성 관점에서 설명해주세요",
            "사회문화적 현상으로서 소셜 미디어의 분석이 제시하는 사회적 함의와 윤리적 질문도 포함해주세요"
        ])
        
    elif "역사" in purpose or "문화 연구" in purpose:
        builder.add_role(
            "역사/문화 연구자",
            "역사학과 문화연구의 방법론을 통합하여 과거 사건과 문화 현상을 맥락 속에서 해석하고 현재와의 연관성을 분석하는 학자로, 다양한 역사적 자료와 문화적 텍스트를 비판적으로 읽는 전문가"
        )
        
        builder.add_context(
            f"저는 역사/문화 연구를 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"1960-70년대 미국의 대항문화 운동(반전 운동, 히피 문화, 민권 운동 등)을 "
            f"역사적, 문화적, 정치적 맥락에서 분석하려고 합니다. 이 운동의 등장 배경, "
            f"다양한 표현 형태, 사회적 영향, 그리고 현대 사회운동과의 연결성을 "
            f"다각적으로 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            "1960-70년대 미국 대항문화 운동의 역사적 배경과 등장 조건(냉전, 베트남 전쟁, 사회적 보수주의 등)을 분석해주세요",
            "다양한 대항문화 표현(음악, 예술, 문학, 패션, 생활양식 등)의 상징적 의미와 정치적 함의를 해석해주세요",
            "대항문화 내 다양한 집단과 운동(히피, 반전, 민권, 페미니즘, 환경 등)의 관계와 긴장을 비교 분석해주세요",
            "공식 역사와 대안적 역사 내러티브 사이의 차이점을 강조하며, 당시 주류 미디어와 대항문화의 관계를 고찰해주세요",
            "대항문화의 역사적 유산과 현대 사회운동(환경, 정의, 정체성 운동 등)에 미친 영향을 분석해주세요",
            "대항문화에 대한 향수와 상품화 현상에 대한 비판적 검토도 포함해주세요"
        ])
        
    elif "심리학" in purpose or "교육학" in purpose:
        builder.add_role(
            "심리/교육 이론가",
            "심리학과 교육학 이론을 통합하여 인간의 학습, 발달, 행동 과정을 분석하고 효과적인 교육적 접근법을 연구하는 학자로, 인지적, 사회적, 정서적 측면을 통합적으로 고려하는 전문가"
        )
        
        builder.add_context(
            f"저는 심리/교육학을 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"창의성 발달과 교육적 촉진 방법에 대해 연구하고 있습니다. 특히 창의성의 "
            f"심리학적 구성 요소, 발달 과정, 사회문화적 영향 요인, 그리고 교육 환경에서 "
            f"창의성을 효과적으로 증진하는 방법에 대한 다양한 이론적 접근을 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            "창의성에 대한 다양한 심리학적 정의와 이론적 모델(인지적, 성격적, 사회문화적 접근)을 비교 분석해주세요",
            "창의성 발달의 단계와 주요 영향 요인(인지적 능력, 성격 특성, 동기, 환경 등)을 발달심리학 관점에서 설명해주세요",
            "창의성에 영향을 미치는 교육 환경 요소와 교육적 개입 방법을 다양한 교육학 이론과 연결하여 분석해주세요",
            "창의성 평가의 방법론적 도전과 다양한 측정 도구의 강점과 한계를 비판적으로 검토해주세요",
            "창의성 교육에 대한 문화적 차이와 사회경제적 요인의 영향을 비교문화적 관점에서 고찰해주세요",
            "창의성 연구와 교육의 윤리적 측면과 사회적 함의에 대한 성찰도 포함해주세요"
        ])
        
    elif "정치학" in purpose or "경제학" in purpose:
        builder.add_role(
            "정치경제 분석가",
            "정치학과 경제학의 분석 틀을 통합적으로 활용하여 복잡한 사회 문제와 정책 이슈를 다차원적으로 분석하는 학자로, 정치적 제도와 경제적 구조의 상호작용을 이해하는 전문가"
        )
        
        builder.add_context(
            f"저는 정치경제학을 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"기후 변화 대응 정책(탄소세, 배출권 거래제, 녹색 산업 지원 등)의 정치경제적 "
            f"측면을 분석하고자 합니다. 특히 이러한 정책의 경제적 효율성, 정치적 실현 가능성, "
            f"사회적 형평성, 국제적 협력 차원에서의 도전과제를 다각적으로 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            "주요 기후 변화 대응 정책 도구(탄소세, 배출권 거래제, 규제, 보조금 등)의 경제적 메커니즘과 효율성을 비교 분석해주세요",
            "기후 정책의 정치적 채택과 실행에 영향을 미치는 제도적, 이해관계적 요인을 다양한 정치경제학 이론으로 설명해주세요",
            "기후 정책의 분배적 영향과 사회적 형평성 문제(산업별, 지역별, 계층별 영향의 차이)를 비판적으로 검토해주세요",
            "국제 기후 협력의 도전과제를 게임 이론, 집단행동 문제, 국제 정치경제 이론을 통해 분석해주세요",
            "다양한 이론적 관점(신고전주의, 제도주의, 생태경제학, 정치생태학 등)에서 기후 정책을 평가하고 비교해주세요",
            "기후 정책의 장기적 사회경제적 전환 가능성과 정치경제적 함의에 대한 비판적 성찰도 포함해주세요"
        ])
        
    else:
        builder.add_role(
            f"{purpose} 전문가", 
            f"{topic}에 대한 깊이 있는 분석과 비판적 해석을 제공하는 학자"
        )
        
        builder.add_context(
            f"저는 인문/사회과학을 공부하는 학생으로 {topic}에 관한 도움이 필요합니다. "
            f"이 주제에 대한 다양한 이론적 관점, 역사적/문화적 맥락, 비판적 해석을 "
            f"종합적으로 이해하고 싶습니다."
        )
        
        builder.add_instructions([
            f"{topic}에 대한 다양한 이론적 관점과 해석을 비교 분석해주세요",
            "관련된 역사적, 사회문화적, 정치경제적 맥락을 고려한 분석을 제공해주세요",
            "주제의 복잡성과 다차원성을 보여주는 비판적 검토를 포함해주세요",
            "다양한 학문적 접근법(학제간)의 통찰을 통합해주세요",
            "관련 텍스트, 담론, 실천의 심층적 해석을 제공해주세요",
            "주제의 현대적 함의와 윤리적/사회적 차원에 대한 성찰도 포함해주세요"
        ])
    
    # 출력 형식 지정
    builder.add_format_instructions(
        f"응답은 {output_format} 형식으로 구성해주세요. "
        f"마크다운 형식을 사용하여 제목, 소제목, 목록 등을 명확히 구분해주세요. "
        f"다음과 같은 구조로 체계적으로 정리해주세요:\n\n"
        f"1. 서론: 분석 대상, 접근 방법, 핵심 질문\n"
        f"2. 이론적 프레임워크: 활용할 주요 이론과 개념적 도구\n"
        f"3. 맥락적 배경: 역사적, 사회문화적, 학문적 맥락\n"
        f"4. 주요 분석: 다양한 관점에서의 핵심 내용 분석\n"
        f"5. 비판적 성찰: 다양한 해석의 한계와 상호보완성\n"
        f"6. 결론: 주요 통찰과 현대적 함의\n\n"
        f"학술적 깊이와 비판적 사고를 보여주되, 대학생 수준에서 이해할 수 있는 명확성을 유지해주세요."
    )
    
    return builder.build()

def main():
    """메인 함수"""
    # 실행 결과를 저장할 때 챕터별 폴더 구조를 사용
    run_exercise(
        title="인문/사회과학 논증 및 분석 방법",
        topic_options=HUMANITIES_PROMPTS_TOPICS,
        get_basic_prompt=get_basic_prompt,
        get_enhanced_prompt=get_enhanced_prompt,
        prompt_summary=PROMPT_SUMMARY,
        learning_points=LEARNING_POINTS
    )

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\n프로그램이 사용자에 의해 중단되었습니다.")
    except Exception as err:
        print(f"\n오류 발생: {err}")
        print("API 키나 네트워크 연결을 확인하세요.")