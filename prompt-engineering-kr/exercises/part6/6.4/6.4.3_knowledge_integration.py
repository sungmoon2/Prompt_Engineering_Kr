"""
분야별 맞춤형 템플릿 개발 실습 모듈

Part 6 - 섹션 6.4.3 실습 코드: 다양한 학문 분야에 적합한 맞춤형 프롬프트 템플릿을 개발하는 방법을 학습합니다.
"""

import os
import sys
from typing import Dict, List, Any, Optional

# 상위 디렉토리를 경로에 추가하여 utils 모듈을 import할 수 있게 설정
current_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.dirname(os.path.dirname(os.path.dirname(current_dir)))
sys.path.append(project_root)

from utils.prompt_builder import PromptBuilder
from utils.exercise_template import run_exercise

# 주제 옵션 정의
TEMPLATE_TOPICS = {
    "1": {"name": "경영학 템플릿", "topic": "경영학 분야 맞춤형 프롬프트 템플릿", "output_format": "템플릿 가이드"},
    "2": {"name": "심리학 템플릿", "topic": "심리학 분야 맞춤형 프롬프트 템플릿", "output_format": "템플릿 가이드"},
    "3": {"name": "공학 템플릿", "topic": "공학 분야 맞춤형 프롬프트 템플릿", "output_format": "템플릿 가이드"},
    "4": {"name": "문학/어학 템플릿", "topic": "문학/어학 분야 맞춤형 프롬프트 템플릿", "output_format": "템플릿 가이드"},
    "5": {"name": "자연과학 템플릿", "topic": "자연과학 분야 맞춤형 프롬프트 템플릿", "output_format": "템플릿 가이드"}
}

# 프롬프트 요약 정보
PROMPT_SUMMARY = {
    "basic": ["분야별 템플릿에 대한 일반적인 질문"],
    "enhanced": [
        "전문가 역할 정의: 특정 분야의 프롬프트 엔지니어링 전문가 역할 부여",
        "구체적 용도: 다양한 학문/과제 상황에 맞는 템플릿 요청",
        "구조적 접근: 역할, 맥락, 지시사항 등 체계적 구성 요소 요청",
        "실용적 적용: 실제 사례와 적용 예시 통한 템플릿 활용법 요청"
    ]
}

# 학습 포인트
LEARNING_POINTS = [
    "각 학문 분야에 맞는 프롬프트 템플릿은 효과적인 응답을 얻는 데 큰 도움이 됩니다",
    "역할, 맥락, 지시사항, 출력 형식의 체계적 구성이 좋은 템플릿의 핵심입니다",
    "분야별 핵심 용어, 개념, 방법론을 템플릿에 적절히 통합하는 것이 중요합니다",
    "템플릿은 융통성 있게 설계하여 다양한 과제와 상황에 맞게 수정할 수 있어야 합니다",
    "잘 설계된 템플릿은 시간을 절약하고 일관된 품질의 응답을 얻는 데 도움이 됩니다"
]

def get_basic_prompt(topic: str) -> str:
    """기본 프롬프트 생성"""
    return f"{topic}에 대해 알려주세요."

def get_enhanced_prompt(topic: str, purpose: str, output_format: str) -> str:
    """향상된 프롬프트 생성"""
    builder = PromptBuilder()
    
    # 분야별 역할 및 맥락 설정
    if "경영학" in topic:
        builder.add_role(
            "경영학 프롬프트 엔지니어링 전문가", 
            "경영학 분야의 다양한 과제와 연구에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 비즈니스 케이스 분석, 전략 개발, 조직 행동 연구 등 다양한 경영학 하위 분야에 맞는 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 경영학과 학생으로 {topic}에 관심이 있습니다. "
            f"사례 분석, 전략 개발, 마케팅 계획 등 다양한 경영학 과제와 연구에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"경영학 분야의 특성을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조와 구성 요소에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            "경영학 분야의 주요 과제 유형(사례 분석, 전략 개발, 마케팅 계획 등)별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "경영학 분야의 주요 프레임워크와 개념을 템플릿에 효과적으로 통합하는 방법을 제안해주세요",
            "다양한 경영학 과제 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 과제에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
        
    elif "심리학" in topic:
        builder.add_role(
            "심리학 프롬프트 엔지니어링 전문가", 
            "심리학 분야의 다양한 연구와 과제에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 실험 설계, 문헌 검토, 사례 연구 등 다양한 심리학 연구 방법에 맞는 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 심리학과 학생으로 {topic}에 관심이 있습니다. "
            f"실험 설계, 문헌 검토, 사례 분석 등 다양한 심리학 과제와 연구에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"심리학의 과학적 방법론과 학문적 특성을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            "심리학 분야의 주요 연구 방법론(실험 연구, 상관 연구, 사례 연구 등)별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "심리학의 과학적 엄격성과 연구 윤리를 템플릿에 효과적으로 반영하는 방법을 제안해주세요",
            "다양한 심리학 연구/과제 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 연구나 과제에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
        
    elif "공학" in topic:
        builder.add_role(
            "공학 프롬프트 엔지니어링 전문가", 
            "공학 분야의 다양한 과제와 프로젝트에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 설계 프로젝트, 문제 해결, 기술 보고서 등 다양한 공학 과제에 맞는 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 공학과 학생으로 {topic}에 관심이 있습니다. "
            f"설계 프로젝트, 공학적 문제 해결, 기술 보고서 등 다양한 공학 과제와 프로젝트에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"공학적 정확성과 체계적인 접근법을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            "공학 분야의 주요 과제 유형(설계 프로젝트, 문제 해결, 기술 보고서 등)별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "공학적 정확성, 기술적 상세함, 실용성을 템플릿에 효과적으로 반영하는 방법을 제안해주세요",
            "다양한 공학 과제/프로젝트 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 과제나 프로젝트에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
        
    elif "문학/어학" in topic:
        builder.add_role(
            "문학/어학 프롬프트 엔지니어링 전문가", 
            "문학과 어학 분야의 다양한 과제와 연구에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 텍스트 분석, 비평적 에세이, 언어학 연구 등 다양한 문학/어학 과제에 맞는 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 문학/어학과 학생으로 {topic}에 관심이 있습니다. "
            f"텍스트 분석, 비평 에세이, 언어학 연구 등 다양한 문학/어학 과제와 연구에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"텍스트 중심의 해석적 접근법과 학문적 특성을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            "문학/어학 분야의 주요 과제 유형(텍스트 분석, 비평 에세이, 언어학 연구 등)별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "해석적 깊이, 비평적 사고, 텍스트 중심 분석을 템플릿에 효과적으로 반영하는 방법을 제안해주세요",
            "다양한 문학/어학 과제/연구 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 과제나 연구에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
        
    elif "자연과학" in topic:
        builder.add_role(
            "자연과학 프롬프트 엔지니어링 전문가", 
            "자연과학 분야의 다양한 연구와 과제에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 실험 보고서, 데이터 분석, 연구 계획 등 다양한 자연과학 과제에 맞는 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 자연과학(물리/화학/생물학/지구과학 등) 전공 학생으로 {topic}에 관심이 있습니다. "
            f"실험 보고서, 데이터 분석, 연구 계획 등 다양한 자연과학 과제와 연구에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"과학적 방법론과 엄격성을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            "자연과학 분야의 주요 과제 유형(실험 보고서, 데이터 분석, 연구 계획 등)별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "과학적 정확성, 방법론적 엄격성, 데이터 기반 접근을 템플릿에 효과적으로 반영하는 방법을 제안해주세요",
            "다양한 자연과학 과제/연구 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 연구나 과제에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
        
    else:
        builder.add_role(
            "학문 분야별 프롬프트 엔지니어링 전문가", 
            "다양한 학문 분야에 최적화된 프롬프트 템플릿을 개발하는 전문가로, 각 분야의 고유한 특성과 요구사항을 반영한 효과적인 프롬프트 작성에 전문성을 가지고 있습니다."
        )
        
        builder.add_context(
            f"저는 대학생으로 {topic}에 관심이 있습니다. "
            f"다양한 학문 분야의 과제와 연구에 활용할 수 있는 효과적인 프롬프트 템플릿을 개발하고 싶습니다. "
            f"각 분야의 고유한 특성과 방법론을 반영하면서 일관된 고품질의 응답을 얻을 수 있는 템플릿 구조에 대해 배우고 싶습니다."
        )
        
        builder.add_instructions([
            f"{topic}에 포함된 분야별로 최적화된 프롬프트 템플릿 구조를 제안해주세요",
            "각 템플릿에 포함되어야 할 핵심 요소(역할, 맥락, 지시사항, 출력 형식 등)와 그 이유를 설명해주세요",
            "각 학문 분야의 고유한 특성과 방법론을 템플릿에 효과적으로 반영하는 방법을 제안해주세요",
            "다양한 과제/연구 유형별 템플릿 예시를 구체적으로 제시해주세요",
            "템플릿을 자신의 과제나 연구에 맞게 수정하고 활용하는 방법에 대한 가이드도 포함해주세요"
        ])
    
    # 출력 형식 지정
    builder.add_format_instructions(
        f"응답은 {output_format} 형식으로 구성해주세요. "
        f"마크다운 형식을 사용하여 제목, 소제목, 목록 등을 명확히 구분해주세요. "
        f"다음 구조를 포함해주세요: "
        f"1) 템플릿 설계의 기본 원칙과 구성 요소 "
        f"2) 과제/연구 유형별 맞춤형 템플릿 구조 "
        f"3) 각 템플릿 구성 요소별 작성 가이드 "
        f"4) 구체적인 템플릿 예시와 활용 사례 "
        f"5) 템플릿 수정 및 최적화 방법 "
        f"코드 블록을 사용하여 템플릿 예시를 명확히 보여주고, 각 구성 요소의 역할과 중요성을 설명해주세요. "
        f"실용적이고 즉시 적용 가능한 가이드를 제공하되, 각 분야의 학문적 특성을 충실히 반영해주세요."
    )
    
    return builder.build()

def main():
    """메인 함수"""
    # 실행 결과를 저장할 때 챕터별 폴더 구조를 사용
    run_exercise(
        title="분야별 맞춤형 템플릿 개발",
        topic_options=TEMPLATE_TOPICS,
        get_basic_prompt=get_basic_prompt,
        get_enhanced_prompt=get_enhanced_prompt,
        prompt_summary=PROMPT_SUMMARY,
        learning_points=LEARNING_POINTS
    )

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\n프로그램이 사용자에 의해 중단되었습니다.")
    except Exception as err:
        print(f"\n오류 발생: {err}")
        print("API 키나 네트워크 연결을 확인하세요.")